<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
    <meta charset="UTF-8">
    <title>Blateck√° ≈°tƒõrkovna</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-ajax@2.1.0/dist/leaflet.ajax.js"></script>
    <script src="./layerstyles.js"></script>
	<link rel="stylesheet" href="css/style.css">
    <style>
      #map {position: absolute; top: 10; right: 0; bottom: 0; left: 10;}
    </style>
	<style>#map { width: 800px; height: 740px; }
	.info { padding: 6px 8px; font: 14px/16px Arial, Helvetica, sans-serif; background: white; background: rgba(255,255,255,0.8); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px; } .info h4 { margin: 0 0 5px; color: #777; }
	.legend { text-align: left; line-height: 18px; color: #555; } .legend i { width: 18px; height: 18px; float: left; margin-right: 8px; opacity: 0.7; }</style>
  </head>
  <body>
	<h1>Blateck√° ≈†tƒõrkovna</h1>
	<p><b>Popis:</b></p>
	<p>Men≈°√≠ p√≠skovna v z√°hybu b√Ωval√©ho meandru ≈ôeky Moravy (dnes od≈ô√≠znut√© rameno) asi 0,8 km<br>severov√Ωchodnƒõ od obce Charv√°ty (okres Olomouc).</p>
	<p><b>Katastr√°ln√≠ √∫zem√≠:</b></p>
	<p>Blatec</p>
	<p><b>Rozloha:</b></p>
	<p>1,1 ha</p>
	<p><b>GPS:</b></p>
	<p>49¬∞31'27.149"N, 17¬∞15'51.832"E:</p>
	<p><b>Ryb√°≈ôsk√Ω rev√≠r:</b></p>
	<p>471 056 Morava ‚Äì Olomouck√© ≈°tƒõrkovny 1A, 10. Blateck√°</p>
	<p><b>P≈ô√≠rodn√≠ stav lokality:</b></p>
	<p>P√≠skovna se nach√°z√≠ na vnit≈ôn√≠ stranƒõ z√°hybu b√Ωval√©ho meandru Moravy, dnes od≈ô√≠znut√©ho od toku.<br>Kromƒõ samotn√©ho meandru s b≈ôehov√Ωmi d≈ôevinn√Ωmi porosty soused√≠ s p√≠skovnou intenzivnƒõ<br>obhospoda≈ôovan√° louka. ≈†ir≈°√≠ okol√≠ lokality tvo≈ô√≠ pole. P√≠skovna je vyu≈æ√≠v√°na pro rybolov<br>a chov kachen.</p>
	<p><b>Zdroj:</b> <a href="http://www.sagittaria.cz/cs/piskovny-charvaty">Sagittaria</a></p>
    <div id="map">
    </div>
    <script>
      const startingLat = 49.523;  
	  const startingLng = 17.266;
	  const startingZoom = 16;
	  const map = L.map('map', {maxZoom:21, minZoom:14}).setView([startingLat, startingLng], startingZoom);

      L.tileLayer(`https://api.mapy.cz/v1/maptiles/aerial/256/{z}/{x}/{y}?apikey=${'5ZtGuQEtvV37xyC_1IJnglc8ZgP53ehgvFqTiHuaFoI'}`, {
		minZoom: 0,
		maxZoom: 19,
		attribution: '<a href="https://api.mapy.cz/copyright" target="_blank">&copy; Seznam.cz a.s. a dal≈°√≠</a>',
	}).addTo(map);


      L.control.scale().addTo(map);

      var mapBounds = new L.LatLngBounds(
          new L.LatLng(49.52, 17.25),
          new L.LatLng(49.54, 17.27));
      var tileLayer = L.tileLayer(`tiles/{z}/{x}/{y}.png`, {
          tileSize: 256,
          //zoomOffset: -1,
          bounds: mapBounds,
          maxZoom: 21,
          minZoom: 14,
          attribution: 'Kolib√°ƒç, Kov√°≈ô, S√Ωkora; Katedra geoinformatiky',
          errorTileUrl: 'tiles/404.png'
          //crossOrigin: true
      }).addTo(map);

      var pathPolyLayer = new L.geoJson.ajax('./layers/pathpoly.json',
                                             { style: pathStyle });

      var pathLineLayer = new L.geoJson.ajax('./layers/pathline.json',
                                             { style: { ...pathStyle, ...pathLineStyle } })
          .addTo(map);

      var riverPolyLayer = new L.geoJson.ajax('./layers/riverpoly.json',
                                              { style: waterStyle })
          .bindPopup(function (layer) {
              return layer.feature.properties.popis;
          });
      riverPolyLayer.on('mouseover', function (e) {
          this.setStyle({ ...waterStyle, ...waterHoverStyle });
      });
      riverPolyLayer.on('mouseout', function (e) {
          this.setStyle(waterStyle);
      });

      var riverLineLayer = new L.geoJson.ajax('./layers/riverline.json',
                                              { style: { ...waterStyle, ...riverLineStyle } })
          .bindPopup(function (layer) {
              return layer.feature.properties.popis;
          }).addTo(map);
      riverLineLayer.on('mouseover', function (e) {
          this.setStyle({ ...waterStyle, ...riverLineStyle, ...waterLineHoverStyle });
      });
      riverLineLayer.on('mouseout', function (e) {
          this.setStyle({ ...waterStyle, ...riverLineStyle });
      });

      var waterLayer = new L.geoJson.ajax('./layers/water.json',
                                          { style: sterkovnaStyle })
          .bindPopup(function (layer) {
              return layer.feature.properties.popis;
          }).addTo(map);
      waterLayer.on('mouseover', function (e) {
          this.setStyle({ ...waterStyle, ...waterHoverStyle });
      });
      waterLayer.on('mouseout', function (e) {
          this.setStyle(waterStyle);
      });

      var gardenLayer = new L.geoJson.ajax('./layers/garden.json',
                                          { style: gardenStyle });

      var meadowLayer = new L.geoJson.ajax('./layers/meadow.json',
                                          { style: meadowStyle });

      var woodsLayer = new L.geoJson.ajax('./layers/woods.json',
                                          { style: woodsStyle });

      var fieldsLayer = new L.geoJson.ajax('./layers/fields.json',
                                          { style: fieldsStyle });

      // layer control
      var pathGroup = L.layerGroup([pathPolyLayer, pathLineLayer]);
      var riverGroup = L.layerGroup([riverPolyLayer, riverLineLayer]);
      var overlayLayers = {
          "Blateck√° ≈°tƒõrkovna": waterLayer,
          "≈òeka Morava": riverGroup,
          "Cesty": pathGroup,
          "Zahrada": gardenLayer,
          "Louky": meadowLayer,
          "Les": woodsLayer,
          "Pole": fieldsLayer
      };
      L.control.layers(null, overlayLayers).addTo(map);

      // zoom control
      function manageLayerVisibility() {
          var zoomLevel = map.getZoom();

          if (zoomLevel >= 17) {
              if (!map.hasLayer(pathPolyLayer))  { map.addLayer(pathPolyLayer); }
              if (map.hasLayer(pathLineLayer))   { map.removeLayer(pathLineLayer); }
              if (!map.hasLayer(riverPolyLayer)) { map.addLayer(riverPolyLayer); }
              if (map.hasLayer(riverLineLayer))  { map.removeLayer(riverLineLayer); }
              riverPolyLayer.setStyle(closePolyStyle);
              waterLayer.setStyle(closePolyStyle);
          } else {
              if (map.hasLayer(pathPolyLayer))   { map.removeLayer(pathPolyLayer); }
              if (!map.hasLayer(pathLineLayer))  { map.addLayer(pathLineLayer); }
              if (map.hasLayer(riverPolyLayer))  { map.removeLayer(riverPolyLayer); }
              if (!map.hasLayer(riverLineLayer)) { map.addLayer(riverLineLayer); }
              waterLayer.setStyle(distantPolyStyle);
          }
      }
      map.on('zoomend', manageLayerVisibility);
      map.on('overlayadd', manageLayerVisibility);
	  
		
		function getColor(d) {
			return d > 6  ? '#E1B88D' :
				d > 5   ? '#267F00' :
				d > 4   ? '#00FF21' :
				d > 3   ? '#B6FF00' :
				d > 2   ? '#eef0d5' :
				d > 1   ? '#0094FF' : '#0026FF';
		}
		const legend = L.control({position: 'bottomright'});

		legend.onAdd = function (map) {

		const div = L.DomUtil.create('div', 'info legend');
		const grades = [0, 1, 2, 3, 4, 5, 6];
		const nazvy = ["Blateck√° ≈†tƒõrkovna", "Morava", "Cesty", "Zahrada", "Louky", "Les", "Pole"];
		const titleLeg = "<b>Rozdƒõlen√≠ krajiny</b>"
		const labels = [`${titleLeg}`];
		let from, to;

		for (let i = 0; i < grades.length; i++) {
			from = grades[i];
			typy = nazvy[i];
			to = grades[i + 1];

			labels.push(`<i style="background:${getColor(from + 1)}"></i> ${typy}`);
		}

		div.innerHTML = labels.join('<br>');
		return div;
	};
	legend.addTo(map);
	L.Control.Home = L.Control.extend({
        onAdd: function(map) {
            const container = L.DomUtil.create('div', 'leaflet-bar leaflet-control');
            const button = L.DomUtil.create('a', 'home-icon', container);
            button.href = '#'; button.title = "Dom≈Ø"; button.innerHTML = 'üè†';
            button.onclick = function(e) { e.preventDefault(); map.setView([startingLat, startingLng], startingZoom); }
            L.DomEvent.disableClickPropagation(container);
            return container;
        },
    });
    map.addControl(new L.Control.Home({ position: 'topleft' }));
    </script>
  </body>
</html>
